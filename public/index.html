<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title id='title'>Robot Console</title>
  <script src="/socket.io/socket.io.js"></script>
  <script src="joystick.js" charset="utf-8"></script>
</head>

<style>
body{
  overflow: hidden;
  font-family: Tahoma, Geneva, sans-serif;
  user-select: none;
}
.image{
  position: absolute;
  top: 40px;
  left: 50%;
  transform: translateX(-50%);
  height:calc(100% - 40px);
  z-index:0;
}
.label{
  font-weight: normal;
}
/* widget background */
.panel{
  position: absolute;
  z-index: 9;
  background-color: #f2f2f2;
  text-align: center;
  border-radius: 5px;
}
/* extra css to hold widgets in container */
.source{
  left:25px;
  z-index: 50;
  position: relative;
  margin-top: 20px;
  margin-bottom: 20px;
  box-shadow:1px 1px 10px grey;
}
.canvas{
  position: absolute;
  left:0px;
  top:20px;
}
/* top bar of widget */
#header {
  padding: 2px;
  cursor: move;
  z-index: 10;
  background-color: #54996c;
  color: #fff;
  border-radius: 5px 5px 0px 0px;
}
#resize{
  cursor:nwse-resize;
  position:absolute; right:0px; bottom:0px; width:15px; height:15px;
}
.widgetHolder{
  position: absolute;
  left: 0px;
  top: 50px;
  width: 260px;
  height: calc(100% - 50px);
  background-color: #e3e3e3;
  overflow-y: scroll;
  z-index: 40;
  transition: all 0.6s;
}
/* css for the settings gear icon on each widget*/
#configButton{
  position: absolute;
    right: -7px;
    top: -3px;
    border: none;
    background: none;
    font-size: 20px;
    display: none;
}
#configButton:hover{
  filter: brightness(85%);
}
.darken:hover{
  filter: brightness(90%);
  cursor: pointer;
}
.settingInput{
  width: calc(100% - 50px);
  height: 30px;
  border-radius: 5px;
  border-width: 1px;
  font-family: Tahoma, Geneva, sans-serif;
  font-weight: normal;
  font-size:17px;
  padding-left: 5px;
}
.miniInput{
  width: 80px;
  height: 30px;
  margin:5px;
  border-radius: 5px;
  border-width: 1px;
  font-family: Tahoma, Geneva, sans-serif;
  font-weight: normal;
  font-size:17px;
  padding-left: 5px;
}
.settingsLabel{
  font-family: Tahoma, Geneva, sans-serif;
  font-weight: bold;
  font-size:17px;
}
.button_ap{
  cursor:pointer;
  font-size:15px;
  margin-top:0px;
  width:100%;
  height:calc(100% - 23px);
  background-color:internal-light-dark(rgb(239, 239, 239), rgb(74, 74, 74));
  cursor:pointer;
  z-index:102;
}
.button_apPressed{
  background-color: #e6e6e6;
  border-width:1px;
}
.navBarButton{
  margin-top:10px;
  height:30px;
  margin-right: 5px;
  background-color: #74bad6;
  border-radius: 5px;
  border: 0px;
  cursor: pointer;
}
.navBarButton:hover{
  filter:brightness(90%);
}
button:focus {outline:0;}
.navBar{
  position: absolute;
  z-index: 95;
  width: 100%;
  height: 50px;
  top: 0px;
  left: 0px;
  background-color: #548499;
  display: inline-flex;
}
.toggleWidgetHolder{
  position:absolute;
  top:58px;
  left:192px;
  z-index:106;
  background-color:#bbb;
  border:none;
  border-radius:5px;
  width:45px;
  height:25px;
  transition: left 0.6s;
}
.toggleWidgetHolder:hover{
  filter:brightness(85%);
  cursor:pointer;
}
.showOnDrive{
  visibility: visible;
}
.checkbox{
	zoom: 1.5;
	transform: scale(1.0);
	-ms-transform: scale(1.1);
	-webkit-transform: scale(1.0);
	-o-transform: scale(1.1);
	-moz-transform: scale(1.1);
	-ms-origin:0 0;
	-webkit-origin:0 0;
	-o-origin:0 0;
	-ms-origin:0 0;
}
.checkboxLabel{
	font-size:20px;
}
/* The slider itself */
.slider {
  -webkit-appearance: none;  /* Override default CSS styles */
  appearance: none;
  width: calc(100% - 5px); /* Full-width */
  height: 25px; /* Specified height */
  background: #d3d3d3; /* Grey background */
  outline: none; /* Remove outline */
  opacity: 0.7; /* Set transparency (for mouse-over effects on hover) */
  -webkit-transition: .2s; /* 0.2 seconds transition on hover */
  transition: opacity .2s;
}
.vertical{
	position:absolute;
	transform-origin:0 0;
	transform: rotate(90deg);
	left:25px;
	width:100px;
}
/* Mouse-over effects */
.slider:hover {
  opacity: 1; /* Fully shown on mouse-over */
}

/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */
.slider::-webkit-slider-thumb {
  -webkit-appearance: none; /* Override default look */
  appearance: none;
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #4CAF50; /* Green background */
  cursor: pointer; /* Cursor on hover */
}

.slider::-moz-range-thumb {
  width: 25px; /* Set a specific slider handle width */
  height: 25px; /* Slider handle height */
  background: #4CAF50; /* Green background */
  cursor: pointer; /* Cursor on hover */
}


.imageTile{
	position:absolute;
	left:500px;
	top:55px;
	border-radius: 10px;
	width:100px;
	border: solid;
	border-color: yellow;
	cursor: pointer;
	transition-property: all;
	transition-duration:0.7s;
}
.infoIcon{
	position:absolute;
	right:5px;
	top:5px;
	width:40px;
	height:40px;
	cursor:pointer;
}
.infoIcon:hover{
	filter:brightness(85%)
}
#infoPanel{
	position:absolute;
	width:300px;
	height:400px;
	background-color:#172a4a;
	top:50px;
	right:0px;
	border-radius:0px 0px 0px 10px;
	visibility:hidden;
}
#color_ap{
	background-color:#32cd32;
	width:100%;
	left:0px;
}
#inputboxbutton{
	position:absolute;
	right:5px;
	top:27px;
	width:60px;
	height:25px;
	background-color:#FFF;
	border-radius:5px;
	border:1px;
	border-color:#000;
	cursor:pointer;
}
#inputboxbutton:hover{
	filter:brightness(85%);
}
#input_ap{
	position:absolute;
	left:5px;
	top:27px;
	width:calc(100% - 80px);
	height:23px;
	background-color:#FFF;
	border-radius:5px;
	border:1px;
	padding-left:5px;
}
.soundbutton{
	display: block;
	margin: auto auto 5px;
	background-color: #fff;
	border-width: thin;
	border-radius: 5px;
	width:300px;
	height:30px;
	border-color:#000;
	cursor:pointer;
}
.soundbutton:hover{
	filter:brightness(85%);
}
</style>

<body id='body' oncontextmenu="return false;">
<!-- top nav bar -->
<div class='navBar' id='navBar'>
  <h1 class="label" style="color: #FFF;margin:5px 40px 5px 10px;"id='consoleName'>Robot Control</h1>
  <button class="navBarButton" id='driveMode' onclick="toggleDriveMode();">Drive Mode</button>
  <select hidden id='screenSelect' class='navBarButton' onchange="changeScreen(this);">
    <option value='1'>Screen 1</option>
    <option value='2'>Screen 2</option>
  </select>
  <button class="navBarButton" onclick="window.location.href += 'config.html'">Config Settings</button>
  <image class='infoIcon' src='info.png' onclick='toggleInfo()'></image>
  <div id='infoPanel'>
	    <h1 class="label" style="color: #FFF;margin:5px 10px 5px 10px;right:0px;"id='instanceCount'>waiting...</h1>
		<h1 class="label" style="color: #FFF;margin:5px 10px 5px 10px;right:100px;"id='ping'>waiting on ping...</h1>
  </div>
</div>
<image class='image' id='mainImage'></image>
<!-- inside this widget holder is the definitions of each widget -->
<button class='toggleWidgetHolder' onclick="toggleWidgetHolder()">Hide</button>
<div class='widgetHolder' id='widgetHolder'>
  <h1 class="label" style="text-align:center">Inputs</h1>

  <div class="panel source" id="_button" style="width:200px;height:80px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Button<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <button id='button_ap' class="button_ap showOnDrive" type="button">Example Button</button>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_checkbox" style="width:200px;height:52px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Checkbox<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <input id='checkbox_ap' class='checkbox showOnDrive' type='checkbox'><span id='checkbox_text_ap' class='checkboxLabel showOnDrive'>Label</span></input>
    <img src="resize.png" id="resize"></img>
  </div>

  <div class="panel source" id="_joystick" style="width:200px;height:150px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Joystick<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <canvas class='joystickCanvas showOnDrive' id='canvas_ap' width="100px" height="100px"></canvas>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_slider" style="width:200px;height:52px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Slider<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <input min="0" max="100" step="1" id='slider_ap' type='range' class='slider showOnDrive'></input>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_inputbox" style="width:200px;height:57px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Input Box<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <input placeholder='type something...' id='input_ap' class='showOnDrive'></input><button id='inputboxbutton' class='showOnDrive'>Send</button>
    <img src="resize.png" id="resize"></img>
  </div>

  <h1 class="label" style="text-align:center">Outputs</h1>

  <div class="panel source" id="_value" style="width:200px;height:50px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Value<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <h1 id='text_ap' class='textDisplay showOnDrive' style="margin:0px;padding:0px;font-size:20px">ex. 14cm</h1>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_light" style="width:200px;height:45px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Indicator<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <div class='showOnDrive' id='color_ap'><h1 class='textDisplay' id='text_ap' style="margin:0px;padding:0px;font-size:20px">label</h1></div>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_gauge" style="width:200px;height:200px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Gauge<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <canvas class='canvas showOnDrive' id='gauge_ap' width="200px" height="180px" data-config='{"min":0,"max":100,"bigtick":20,"smalltick":4,"title":"CPU temp"}'></canvas>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_audio" style="width:200px;height:70px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Audio Indicator<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <image id='speaker_ap' class='showOnDrive' src='speaker.svg' style='height:40px;position:absolute:left:0px;top:26px'></image>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <h1 class="label" style="text-align:center">Non ROS</h1>
  
  <div class="panel source" id="_text" style="width:200px;height:50px;" onmouseenter='mouseEnterWidget(this)' onmouseleave='mouseLeaveWidget(this)'>
    <div id="header">Text<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <h1 id='text_ap' class='textDisplay showOnDrive' style="margin:0px;padding:0px;font-size:20px">some text</h1>
    <img src="resize.png" id="resize"></img>
  </div>
  
  <div class="panel source" id="_box" style="z-index:2;width:200px;height:100px;background:rgba(0,0,0,0)">
    <div id="header">Panel<button onclick="openConfig(this)" id="configButton">⚙️</button></div>
    <div id='panel_ap' class='showOnDrive' style="opacity:0.5; position:absolute;left:0px;top:22px;width:100%;height:calc(100% - 22px);background-color:#DDD"></div>
    <img src="resize.png" id="resize"></img>
  </div>
</div>
<!-- mask that blocks interaction, for the config settings panel etc. -->
<div id='mask' style="display: none; position: absolute; z-index: 120; background-color:rgba(0, 0, 0, 0.6); width:100%; height:100%; top:0px; left:0px;"></div>

<!-- config settins panel -->
<div id='configWindow' class="panel" style="display: none;z-index: 121;width:50%; height:70%; left:25%; top:15%; overflow-y:auto">
  <h1 class='settingsLabel' id='topiclabel' style="margin-top: 20px;">ROS Topic Name</h1>
  <input class="settingInput" id='topicTitle'></input>
  <button onclick="applyConfigChanges();removeWidgetFromScreen(elementOpenInConfig);" class="label darken" style="font-size: 20px;background-color:#fc9d9d; position:absolute; width:120px;height:55px;border:none;border-radius:5px;bottom:10px;left:10px;">Delete</button>
  <button onclick="applyConfigChanges();" class="label darken" style="font-size: 20px;background-color:#9de7fc; position:absolute; width:120px;height:55px;border:none;border-radius:5px;bottom:10px;right:10px;">Done</button>
</div>
<script src="widgets.js" charset="utf-8"></script>
<script src="main.js" charset="utf-8"></script>
</body>
</html>
